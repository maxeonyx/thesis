\RequirePackage{luatex85}
\RequirePackage{standalone}
\documentclass{standalone}

\input{figure-preamble.tex}

\begin{document}

\begin{tikzpicture}
    \usetikzlibrary{graphs, graphdrawing}
    \usegdlibrary{layered}
    \pgfdeclarelayer{bg}
    \pgfsetlayers{bg,main}
    \tikzstyle{every node}=[draw,fill=white,text width=5cm]

    \graph [layered layout] {

        (categorical) / { \textbf{\Cref{ss:cat-dist}}: Categorical distribution/classification. };

        (attn) / { \textbf{\Cref{S:attn}}: The attention operation. };

        (causal) / { \textbf{\Cref{ss:cau}}: Autoregressive pretraining. };

        (a-autoreg /) { \textbf{\Cref{sss:pretraining-triples}}: Arbitrary-order autoregressive pretraining. };

        (deconly) / { \textbf{\Cref{ss:decoder-only}}: Decoder-only transformers. };

        (a-autoreg /) { \textbf{\Cref{sss:pretraining-triples}}: Arbitrary-order autoregressive pretraining. };

        (amse) / { \textbf{\Cref{ss:amse}}: Mean-squared angular error loss. };

        (vonmises) / { \textbf{\Cref{ss:von-mises}}: von-Mises distribution over angles. };

        (hand) / { \textbf{\Cref{ss:hand}}: Hand pose data. };

        % chapter 4: arbitrary order sampling
        (chapter4) / {\textbf{\Cref{C:a-o-sampling}}: Arbitrary order sampling on MNIST};

        % chapter 6.2: transformer for hand pose prediction
        (chapter62) / {\textbf{\Cref{C:hand-model}, \Cref{S:mean-model}}: Predicting the next frame in a hand animation};

        % chapter 6.3: probabilistic model for hand pose prediction
        (chapter63) / {\textbf{\Cref{C:hand-model}, \Cref{S:prob-model}}: A flexible probabilistic model for hand motion prediction};

        (categorical) -- (chapter4);

        (attn) -- (causal) -- (a-autoreg) -- (chapter4);

        (attn) -- (deconly);

        (deconly) -- (chapter4);

        (causal) -- (chapter62);
        (deconly) -- (chapter62);
        (amse) -- (chapter62);

        (causal) -- (chapter63);
        (deconly) -- (chapter63);
        (vonmises) -- (chapter63);

    };

\end{tikzpicture}

\end{document}
